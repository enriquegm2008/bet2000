<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Web de Apuestas Deportivas</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

  <!-- Header -->
  <header>
    <h1><span class="bet">Bet</span><span class="numero">2000</span></h1>
    <nav>
      <button onclick="window.location.href='registrarse.html'">Registrarse</button>
      <button onclick="window.location.href='iniciar-sesion.html'">Iniciar sesión</button>
    </nav>
  </header>

  <!-- Contenido principal -->
  <main>
    <section class="partidos">
      <h2>Partidos disponibles para apostar</h2>
      <table>
        <thead>
          <tr>
            <th>Equipos</th>
            <th>1</th>
            <th>X</th>
            <th>2</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <div class="equipo">
                <img src="images/RealMadrid.png" alt="Real Madrid" class="escudo">
                <span>Real Madrid</span>
              </div>
              <div class="equipo">
                <img src="images/Barcelona.png" alt="Barcelona" class="escudo">
                <span>Barcelona</span>
              </div>
            </td>
            <td class="cuotas">
              <span>1.80</span>
            </td>
            <td class="cuotas">
              <span>3.20</span>
            </td>
            <td class="cuotas">
              <span>2.10</span>
            </td>
          </tr>
          <tr>
            <td>
              <div class="equipo">
                <img src="images/ManchesterCity.png" alt="Manchester City" class="escudo">
                <span>Manchester City</span>
              </div>
              <div class="equipo">
                <img src="images/Liverpool.png" alt="Liverpool" class="escudo">
                <span>Liverpool</span>
              </div>
            </td>
            <td class="cuotas">
              <span>2.50</span>
            </td>
            <td class="cuotas">
              <span>3.00</span>
            </td>
            <td class="cuotas">
              <span>2.80</span>
            </td>
          </tr>
        </tbody>
      </table>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <p>&copy; 2025 Bet2000 - Apuestas ficticias</p>
  </footer>

  <!-- Script de Firebase y lógica de apuestas -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-auth.js";
    import { getFirestore, doc, setDoc, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBT3yANkLvpNicR0GIxXsV6kWM62tMeQFQ",
      authDomain: "bet2000-e000a.firebaseapp.com",
      projectId: "bet2000-e000a",
      storageBucket: "bet2000-e000a.appspot.com",
      messagingSenderId: "547808109527",
      appId: "1:547808109527:web:8821956a2edc93a90b2192",
      measurementId: "G-MYWP8TMXH9"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    async function obtenerSaldo(userId) {
      const docRef = doc(db, "users", userId);
      const docSnap = await getDoc(docRef);
      return docSnap.exists() ? docSnap.data().saldo : 0;
    }

    async function actualizarSaldo(userId, cantidad) {
      const userRef = doc(db, "users", userId);
      await updateDoc(userRef, { saldo: cantidad });
    }

    async function apostar(cantidadApuesta) {
      const userId = localStorage.getItem("userId");
      const saldoActual = await obtenerSaldo(userId);

      if (cantidadApuesta > saldoActual) {
        alert("No tienes suficiente saldo.");
        return;
      }

      const nuevoSaldo = saldoActual - cantidadApuesta;
      await actualizarSaldo(userId, nuevoSaldo);

      alert(`Apuesta realizada con éxito. Tu nuevo saldo es ${nuevoSaldo} puntos`);
    }
  </script>

</body>
</html>
